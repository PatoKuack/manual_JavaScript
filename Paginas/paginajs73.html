<!DOCTYPE html>
<html lang="es">
<head>
  <!-- No guardar cache en navegadores -->
  <meta http-equiv="Last-Modified" content="0">
  <meta http-equiv="Cache-Control" content="no-cache, mustrevalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <!-- ------------------- -->
  <!-- Estilos -->
  <link rel="stylesheet" href="../Estilos/tailwind_dist/tailwind.css">
  <!-- ------------------- -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>React-Composición</title>
</head>
<body class="bg-react bg-[length:200px_200px] bg-center">
  <header>
    <section class="pk-section__v2">
      <h1 class="text-center text-2xl">Composición de componentes.</h1>
    </section>
  </header>
  <main>
    <!-- División de componentes. -->
    <section class="pk-section__v2">
      <h2>División de componentes.</h2>
      <p>Para reducir la <i>"deuda técnica</i> en un proyecto con React, se pueden dividir los componentes entre los que consumen el estado general de la aplicación (componentes de UI, stateless) y los que crean sus propios estados (stateful).</p>
      <div class="pk-code__v2">
        function App( ) {<br/>
        const [ ejemplo, setEjemplo ] = React.useState( ' ' );
        <span class="block indent-4">return(</span>
        <span class="block indent-8">&#60;EjProvider&#62;</span>
        <span class="block indent-12">&#60;React.Fragment&#62;</span>
        <span class="block indent-16">&#60;Ejemplo1 ejemplo={ ejemplo } /&#62;</span>
        <span class="block indent-16">&#60;Ejemplo2&#62;</span>
        <span class="block indent-20">&#60;Ejemplo3 setEjemplo={ setEjemplo } /&#62;</span>
        <span class="block indent-16">&#60;/Ejemplo2&#62;</span>
        <span class="block indent-12">&#60;/React.Fragment&#62;</span>
        <span class="block indent-8">&#60;/EjProvider&#62;</span>
        <span class="block indent-4">);</span>
        }<br/><br/>
        function Ejemplo1( { ejemplo } ) {<br/>
        <span class="block indent-4">return(</span>
        <span class="block indent-8">...</span>
        <span class="block indent-4">);</span>
        }<br/><br/>
        function Ejemplo2( { children } ) {<br/>
        <span class="block indent-4">return(</span>
        <span class="block indent-8">&#60;React.Fragment&#62;</span>
        <span class="block indent-12">{ children }</span>
        <span class="block indent-8">&#60;/React.Fragment&#62;</span>
        <span class="block indent-4">);</span>
        }<br/><br/>
        function Ejemplo3( { setEjemplo } ) {<br/>
        <span class="block indent-4">return(</span>
        <span class="block indent-8">...</span>
        <span class="block indent-4">);</span>
        }
      </div>
      <p>Si se manera esta forma de utilizar los componentes, incluso se puede evitar utilizar React Context y solo usar hooks, de esta manera el código será más legible y fácil de comprender.</p>
    </section>
    <!-- Render props y reder functions. -->
    <section class="pk-section__v2">
      <h2>Render props y reder functions.</h2>
      <h3>Render props</h3>
      <p>Es un patrón igual que los componentes, delega la responsabilidad de su contenido a otros componentes de una manera más específica determinando qué, cuándo y dónde se va a renderizar cada elemento del componentes. Manda las funciones o información del componente por medio de las propiedades de los componentes y no por medio del contenido.</p>
      <div class="pk-code__v2">
        &#60;RenderProps
        <span class="block indent-4">renderProp={ <b>info => (</b> &#60;OtroComp { ...info } /&#62; <b>)</b> }</span>
        /&#62;
      </div>
      <h3>Render functions</h3>
      <p>Es un patrón igual que el Consumer, permite entregar la información de los componentes en una función.</p>
      <div class="pk-code__v2">
        &#60;RenderFunction&#62;
        <span class="block indent-4">{ <b>info => (</b></span>
        <span class="block indent-8">&#60;OtroComp { ...info } /&#62;</span>
        <span class="block indent-4"><b>)</b> }</span>
        &#60;/RenderFunction&#62;
      </div>
      <p>Ejemplo de composición de componentes con Render props y Render functions:</p>
      <div class="pk-code__v2">
        import React from 'react';<br/>
        import Empty from './Empty';<br/>
        import ObjectItem from './ObjectItem';<br/><br/>
        function <u>App</u>( ) {<br/>
        const [ loading, objectList ] = React.useState( true );
        <span class="block indent-4">return(</span>
        <span class="block indent-8">&#60;EjList</span>
        <span class="block indent-12">loading = { loading }</span>
        <span class="block indent-12">objectList = { objectList }</span>
        <span class="block indent-12">onEmpty = { ( ) => &#60;Empty/&#62; }</span>
        <span class="block indent-12 font-light italic">{/* La propiedad render mandará una función con un componente. */}</span>
        <span class="block indent-12">render = { e => (</span>
        <span class="block indent-16">&#60;ObjectItem</span>
        <span class="block indent-20">key={object.text)</span>
        <span class="block indent-20">text={object.text)</span>
        <span class="block indent-16">/&#62;</span>
        <span class="block indent-12">);</span>
        <span class="block indent-8">/&#62;</span>
        <span class="block indent-4">);</span>
        }
      </div>
      <div class="pk-code__v2">
        import React from 'react';<br/>
        function <u>EjList</u>( props ) {<br/>
        <span class="block indent-4">return(</span>
        <span class="block indent-8">&#60;section&#62;</span>
        <span class="block indent-12 font-light italic">{/* Si la propiedad loading no es true (o no tiene contenido)</span>
        <span class="block indent-12 font-light italic">y si objectList es 0 (o false o null)</span>
        <span class="block indent-12 font-light italic">se ejecutará la propiedad función onEmpty */}</span>
        <span class="block indent-12">{ ( !props.loading && !props.objectList.lenght ) && props.onEmpty( ) }</span>
        <span class="block indent-12 font-light italic">{/* Por cada elemento de la lista objectList</span>
        <span class="block indent-12 font-light italic">se ejecutará la propiedad render. */}</span>
        <span class="block indent-12">{ ( props.objectList.map ( props.render ) ) }</span>
        <span class="block indent-8">&#60;/section&#62;</span>
      </div>
    </section>
    <!-- React.Children y React.cloneElement. -->
    <section class="pk-section__v2">
      <h2>React.Children y React.cloneElement.</h2>
      <h3>React.Children</h3>
      <p>Sirve para poder pasar propiedades especiales a los componentes hijos de los componentes contenedores. Su desventaja es que aunque pueda mandar varias propiedades al elemento clonado, solamente puede recibir un elemento para ser clonado.</p>
      <div class="pk-code__v2">
        import React from 'react';<br/>
        import EjHijo from './EjHijo';<br/><br/>
        function <u>App</u>( ) {<br/>
        const [ loading, objectList ] = React.useState( true );
        <span class="block indent-4">return(</span>
        <span class="block indent-8">&#60;EjPadre loading={ loading }&#62;</span>
        <span class="block indent-12">&#60;EjHijo /&#62;</span>
        <span class="block indent-8">&#60;/EjPadre&#62;</span>
        <span class="block indent-4">);</span>
      </div>
      <div class="pk-code__v2">
        function <u>EjPadre</u>( <b>{ children, loading }</b> ) {
          <span class="block indent-4">return(</span>
          <span class="block indent-8">&#60;section&#62;</span>
          <span class="block indent-12 font-light italic">{/* Recibirá el elemento del contenido (EjHijo)</span>
          <span class="block indent-12 font-light italic">y le mandará la propiedad loading */}</span>
          <span class="block indent-12 font-bold">React.cloneElement(child, { loading: loading } )</span>
          <span class="block indent-8">&#60;/section&#62;</span>
          <span class="block indent-4">);</span>
        }
      </div>
      <h3>React.Children</h3>
      <p>Tiene muchos métodos para ayudar a utilizar el contenido que se le pasa a los componentes.</p>
      <ul class="mb-4 ml-4 list-disc list-inside">
        <li>React.Children<u>.toArray( children )</u></li>
      </ul>
      <p>Recibe el contenido del componente (children) y devuelve un array con los comonentes o elementos que se reciban, no importa si no recibe elementos o si recibe solo uno, siempre devuelve un array con los componentes y elementos como contenido.</p>
      <div class="pk-code__v2">
        import React from 'react';<br/>
        import EjHijo1 from './EjHijo1';<br/>
        import EjHijo2 from './EjHijo2';<br/><br/>
        function <u>App</u>( ) {<br/>
        const [ loading, objectList ] = React.useState( true );
        <span class="block indent-4">return(</span>
        <span class="block indent-8">&#60;EjPadre loading={ loading }&#62;</span>
        <span class="block indent-12">&#60;EjHijo1 /&#62;</span>
        <span class="block indent-12">&#60;EjHijo2 /&#62;</span>
        <span class="block indent-8">&#60;/EjPadre&#62;</span>
        <span class="block indent-4">);</span>
      </div>
      <div class="pk-code__v2">
        function <u>EjPadre</u>( <b>{ children, loading }</b> ) {
        <span class="block indent-4">return(</span>
        <span class="block indent-8">&#60;section&#62;</span>
        <span class="block indent-12 font-light italic">{/* Recibirá el elemento del contenido (EjHijo) */}</span>
        <span class="block indent-12">{ React.Children</span>
          <span class="block indent-16 font-light italic">{/* Transformará el contenido en un Array */}</span>
          <span class="block indent-16">.toArray(children)</span>
          <span class="block indent-16 font-light italic">{/* Con cada elemento del array se usará React.cloneElement */}</span>
        <span class="block indent-16">.map( ( child ) =></span>
        <span class="block indent-20">React.cloneElement( child, { loading: loading } )</span>
        <span class="block indent-16">)</span>
        <span class="block indent-12">}</span>
        <span class="block indent-8">&#60;/section&#62;</span>
        <span class="block indent-4">);</span>
        }
      </div>
    </section>
  </main>
  <footer>
    <section class="pk-section__v2">
      <h3>Referencias:</h3>
      <p>
        <a class="link" href="https://refactorizando.com/stateful-vs-stateless-arquitectura/" target="_blank" rel="noopener noreferrer">Arquitecturas Stateful y Stateless.</a><br/>
        <a class="link" href="https://frontarm.com/james-k-nelson/passing-data-props-children/" target="_blank" rel="noopener noreferrer">How to pass data to props.children.</a><br/>
        <a class="link" href="https://medium.com/@justynazet/passing-props-to-props-children-using-react-cloneelement-and-render-props-pattern-896da70b24f6" target="_blank" rel="noopener noreferrer">Using React.cloneElement.</a><br/>
        <a class="link" href="https://reactjs.org/docs/react-api.html#reactchildren" target="_blank" rel="noopener noreferrer">React.Children.</a><br/>
      </p>
    </section>
  </footer>
</body>
</html>